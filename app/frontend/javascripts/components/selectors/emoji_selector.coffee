Modal = React.createFactory require('../shared/modal')

Promise = $.Deferred
{div, button, h4, ul, li, a, span} = React.DOM

EmojiSelector = React.createClass
  displayName: 'EmojiSelector'

  componentDidMount: ->
    @promise = new Promise()

  getDefaultProps: ->
    tabs: [
      'ðŸƒ ðŸ’ª ðŸŽ´ ðŸŽ½ ðŸŽ¾ ðŸŽ¿ ðŸ€ ðŸ ðŸ‚ ðŸ„ ðŸ† ðŸ‡ âš½ âš¾ ðŸ‰ ðŸˆ ðŸŠ ðŸŽ¸ ðŸ“¯ ðŸŽµ ðŸŽ¶ ðŸŽ· ðŸŽ¹ ðŸŽº ðŸŽ» ðŸŽ¼ ðŸŽ’ ðŸŽ“ ðŸ”¬ ðŸ”­ ðŸŽ  ðŸŽ¡ ðŸŽ¢ ðŸŽ£ ðŸŽ¤ ðŸŽ¥ ðŸŽ¦ ðŸŽ§ ðŸ“– ðŸ“š ðŸŽ¨ ðŸŽ© ðŸŽª ðŸŽ« ðŸŽ¬ ðŸŽ­ ðŸŽ® ðŸ“Ÿ ðŸŽ¯ ðŸŽ° ðŸŽ± ðŸŽ² ðŸŽ³ ðŸ“· ðŸ“¹',
      'ðŸ—¼ ðŸ—» ðŸ—½ ðŸ—¾ ðŸ—¿ ðŸŽ‹ ðŸŽŒ ðŸŽ ðŸŽŽ ðŸŽ ðŸŽ ðŸŽ‘ â›² â›³ â›µ â›º â›½ ðŸ  ðŸ¡ ðŸ¢ ðŸ£ ðŸ¥ ðŸ¤ ðŸ¦ ðŸ§ ðŸ¨ ðŸ© ðŸª ðŸ« ðŸ¬ ðŸ­ ðŸ® ðŸ¯ ðŸ°',
      'â„ â‡ â›„ ðŸŒ€ â˜ â˜” âš¡ ðŸ”¥ â˜€ â›… ðŸŒŸ ðŸŒ  âœ¨ â­ ã€½ ðŸŒ ðŸŒƒ ðŸŒ„ ðŸŒ… ðŸŒ† ðŸŒ‡ ðŸŒˆ ðŸŒ‰ ðŸŒŠ ðŸŒ‹ ðŸŒŒ',
      'ðŸŒ ðŸŒ ðŸŒŽ ðŸŒ ðŸŒ‘ ðŸŒ’ ðŸŒ– ðŸŒ— ðŸŒ“ ðŸŒ˜ ðŸŒ” ðŸŒ• ðŸŒ™ ðŸŒš ðŸŒœ ðŸŒ ðŸŒž'
      'ðŸŒ¿ ðŸŒ° ðŸŒ± ðŸŒ´ ðŸŒµ ðŸŒ· ðŸŒ¸ ðŸŒ¹ ðŸŒº ðŸŒ» ðŸŒ¼ ðŸŒ½ ðŸŒ¾ ðŸ€ ðŸ ðŸ‚ ðŸƒ ðŸŒ² ðŸŒ³',
      'ðŸ” ðŸ• ðŸ– ðŸ— ðŸ˜ ðŸ™ ðŸš ðŸ› ðŸœ ðŸ ðŸž ðŸŸ ðŸ  ðŸ¡ ðŸ¢ ðŸ£ ðŸ¤ ðŸ¥ ðŸ„ ðŸ… ðŸ† ðŸ‡ ðŸˆ ðŸ‰ ðŸŠ ðŸŒ ðŸ ðŸŽ ðŸ ðŸ‘ ðŸ’ ðŸ“ ðŸ‹ ðŸ ðŸ¼ ðŸ¦ ðŸ§ ðŸ¨ ðŸ© ðŸª ðŸ« ðŸ¬ ðŸ­ ðŸ® ðŸ¯ ðŸ° ðŸ± ðŸ² ðŸ³ ðŸ´ ðŸµ â˜• ðŸ¶ ðŸ· ðŸ¸ ðŸ¹ ðŸº ðŸ»',
      'ðŸ€ ðŸ ðŸ‚ ðŸƒ ðŸ„ ðŸ… ðŸ† ðŸ‡ ðŸˆ ðŸ‰ ðŸŠ ðŸ‹ ðŸ ðŸ ðŸ“ ðŸ• ðŸ– ðŸª ðŸŒ ðŸ ðŸŽ ðŸ‘ ðŸ’ ðŸ” ðŸ— ðŸ˜ ðŸ™ ðŸš ðŸ› ðŸœ ðŸ ðŸž ðŸŸ ðŸ  ðŸ¡ ðŸ¢ ðŸ£ ðŸ¤ ðŸ¥ ðŸ¦ ðŸ§ ðŸ¨ ðŸ© ðŸ« ðŸ¬ ðŸ­ ðŸ® ðŸ¯ ðŸ° ðŸ± ðŸ² ðŸ³ ðŸ´ ðŸµ ðŸ¶ ðŸ· ðŸ¸ ðŸ¹ ðŸº ðŸ» ðŸ¼ ðŸ½ ðŸ¾',
      'ðŸ˜ ðŸ˜‚ ðŸ˜ƒ ðŸ˜„ ðŸ˜… ðŸ˜† ðŸ˜‰ ðŸ˜Š ðŸ˜‹ ðŸ˜Œ ðŸ˜ ðŸ˜ ðŸ˜’ ðŸ˜“ ðŸ˜” ðŸ˜– ðŸ˜˜ ðŸ˜š ðŸ˜œ ðŸ˜ ðŸ˜ž ðŸ˜  ðŸ˜¡ ðŸ˜¢ ðŸ˜£ ðŸ˜¤ ðŸ˜¥ ðŸ˜¨ ðŸ˜© ðŸ˜ª ðŸ˜« ðŸ˜­ ðŸ˜° ðŸ˜± ðŸ˜² ðŸ˜³ ðŸ˜µ ðŸ˜· ðŸ˜€ ðŸ˜‡ ðŸ˜ˆ ðŸ˜Ž ðŸ˜ ðŸ˜‘ ðŸ˜• ðŸ˜— ðŸ˜™ ðŸ˜› ðŸ˜Ÿ ðŸ˜¦ ðŸ˜§ ðŸ˜¬ ðŸ˜® ðŸ˜¯ ðŸ˜´ ðŸ˜¶ ðŸ˜¸ ðŸ˜¹ ðŸ˜º ðŸ˜» ðŸ˜¼ ðŸ˜½ ðŸ˜¾ ðŸ˜¿ ðŸ™€ ðŸ™… ðŸ™† ðŸ™‡ ðŸ™ˆ ðŸ™‰ ðŸ™Š ðŸ™‹ ðŸ™Œ ðŸ™ ðŸ™Ž ðŸ™',
      'ðŸšƒ ðŸš„ ðŸš… ðŸš‡ ðŸš‰ ðŸšŒ ðŸš ðŸš‘ ðŸš’ ðŸš“ ðŸš• ðŸš— ðŸš™ ðŸšš ðŸš¢ ðŸš¤ ðŸš âœˆ ðŸš€ ðŸš‚ ðŸš† ðŸšˆ ðŸšŠ ðŸš ðŸšŽ ðŸš ðŸš” ðŸš– ðŸš˜ ðŸš› ðŸšœ ðŸš ðŸšž ðŸšŸ ðŸš  ðŸš¡ ðŸš£ ðŸ’º',
      'ðŸ›€ ðŸš¿ ðŸ› ðŸš½ ðŸš¾ ðŸš¦ ðŸš® â™¨ â™» â™¿ âš“ âš  ðŸš¥ ðŸš§ ðŸš¨ ðŸš© ðŸšª ðŸš« ðŸš¬ ðŸš­ ðŸš² ðŸš¶ ðŸš¹ ðŸšº ðŸš» ðŸš¼ ðŸš¯ ðŸš° ðŸš± ðŸš³ ðŸš´ ðŸšµ ðŸš· ðŸš¸ ðŸ›‚ ðŸ›ƒ ðŸ›„ ðŸ›… ðŸ“µ ðŸ”€ ðŸ” ðŸ”‚ ðŸ”„',
      'ðŸ‘¬ ðŸ‘­ ðŸ‘ª ðŸ‘« ðŸ’­ ðŸ’¬ ðŸ‘€ ðŸ‘‚ ðŸ‘ƒ ðŸ‘„ ðŸ‘… âœŒ âœŠ â˜ âœ‹ ðŸ‘† ðŸ‘‡ ðŸ‘ˆ ðŸ‘‰ ðŸ‘Š ðŸ‘‹ ðŸ‘Œ ðŸ‘ ðŸ‘Ž ðŸ‘ ðŸ‘ ðŸ’£ ðŸ’¡ ðŸ’¢ ðŸ’¤ ðŸ’¥ ðŸ’¦ ðŸ’§ ðŸ’¨ ðŸ’© ðŸ’« ðŸ‘¥ ðŸ‘¤ ðŸ‘¦ ðŸ‘§ ðŸ‘¨ ðŸ‘© ðŸ‘® ðŸ‘¯ ðŸ‘° ðŸ‘± ðŸ‘² ðŸ‘³ ðŸ‘´ ðŸ‘µ ðŸ‘¶ ðŸ‘· ðŸ‘¸ ðŸ‘¹ ðŸ‘º ðŸ‘» ðŸ‘¼ ðŸ‘½ ðŸ‘¾ ðŸ‘¿ ðŸ’€',
      'ðŸ‘• ðŸ‘– ðŸ‘— ðŸ‘˜ ðŸ‘™ ðŸ‘š ðŸ‘‘ ðŸ‘’ ðŸ‘“ ðŸ‘” ðŸ‘› ðŸ‘œ ðŸ‘ ðŸ‘ž ðŸ‘Ÿ ðŸ‘  ðŸ‘¡ ðŸ‘¢ ðŸ‘£ ðŸ’ ðŸ’‚ ðŸ’ƒ ðŸ’„ ðŸ’… ðŸ’† ðŸ’‡ ðŸ’ˆ ðŸ’‰ ðŸ’Š',
      'ðŸŽ‰ ðŸŽ€ ðŸŽ ðŸŽ‚ ðŸŽƒ ðŸŽ„ ðŸŽ… ðŸŽ† ðŸŽ‡ ðŸŽˆ ðŸŽŠ ðŸ’‹ ðŸ’Œ ðŸ’ ðŸ’Ž ðŸ’ ðŸ’ ðŸ’‘ ðŸ’’ ðŸ’“ ðŸ’” ðŸ’• ðŸ’– ðŸ’— ðŸ’˜ ðŸ’™ ðŸ’š ðŸ’› ðŸ’œ ðŸ’ ðŸ’ž ðŸ’Ÿ',
      'ðŸ’» ðŸ’¼ ðŸ’½ ðŸ’¾ ðŸ’¿ ðŸ“€ ðŸ“ ðŸ“‚ ðŸ“ƒ ðŸ“„ ðŸ“… ðŸ“† ðŸ“‡ ðŸ’¯ ðŸ’° ðŸ’± ðŸ’² ðŸ’³ ðŸ’´ ðŸ’µ ðŸ’¶ ðŸ’· ðŸ’¸ ðŸ’¹ ðŸ“ˆ ðŸ“‰ ðŸ“Š ðŸ“‹ âŒš âŒ› â° ðŸ“Œ ðŸ“ ðŸ“Ž âœ ðŸ“ ðŸ“ ðŸ“‘ ðŸ“’ ðŸ““ ðŸ“” ðŸ“• ðŸ“– ðŸ“— ðŸ“˜ ðŸ“™ ðŸ“š',
      'ðŸ“ž ðŸ“› ðŸ“œ ðŸ“ â˜Ž ðŸ“  ðŸ“¡ ðŸ“¤ ðŸ“¥ ðŸ“¦ âœ‚ âœ… âœ‰ ðŸ“§ ðŸ“¨ ðŸ“© ðŸ“ª ðŸ“« ðŸ“¬ ðŸ“­ ðŸ“® ðŸ“° ðŸ“± ðŸ“² ðŸ“³ ðŸ“´ ðŸ“¶ ðŸ”ƒ ðŸ”Š ðŸ” ðŸ”Ž ðŸ” ðŸ” ðŸ”‘ ðŸ”’ ðŸ”“ ðŸ”” ðŸ”– ðŸ”— ðŸ”˜ ðŸ”… ðŸ”† ðŸ”‡ ðŸ”‰ ðŸ”•',
      'ðŸ”¦ ðŸ”§ ðŸ”¨ ðŸ”© ðŸ”ª ðŸŒ‚ ðŸ”« ðŸ”® ðŸ“º ðŸ“» ðŸ“¼ ðŸ“¢ ðŸ“£ ðŸ”‹ ðŸ”Œ',
      'â›Ž ðŸ’® âœ³ âœ´ â“ â— â¤ â™ˆ â™‰ â™Š â™‹ â™Œ â™ â™Ž â™ â™ â™‘ â™’ â™“ â™  â™£ â™¥ â™¦ â­• ðŸ’  âž° ðŸ”¯ ðŸ”° ðŸ”±'
    ]
    default_tab: 'ðŸƒ'


  _abort: ->
    @promise.reject()

  _choose: (e) ->
    if e.target.className == 'selector-emoji'
      @promise.resolve(e.target.innerHTML)

  _onKeyDown: (e) ->
    if e.keyCode is 27
      @_abort()

  render: ->
    Modal null,
      div className: 'modal-header',
        h4 className: 'modal-title', "Select emoji"
        div
          className: 'modal-body modal-scrollable'
          ul
            className: "nav nav-tabs", role: "tablist"
            @props.tabs.map (tab) =>
              emojis = tab.split(' ')
              tab_emoji = emojis[0]
              li
                className: if tab_emoji == @props.default_tab then 'active' else '',
                role: "presentation", key: tab_emoji
                a
                  href: "##{tab_emoji}", 'aria-controls': tab_emoji, role: "tab", 'data-toggle': "tab"
                  span className: "selector-emoji",
                    tab_emoji
          div
            className: "tab-content"
            style: {}
            @props.tabs.map (tab) =>
              emojis = tab.split(' ')
              tab_emoji = emojis[0]
              div
                className: "tab-pane" + if tab_emoji == @props.default_tab then ' active' else ''
                onClick: @_choose
                role: "tabpanel", id: tab_emoji, key: tab_emoji
                emojis.map (emoji) =>
                  span
                    className: "selector-emoji", key: emoji
                    emoji


      div className: 'modal-footer',
        div className: 'text-right',
          button
            role: 'abort'
            type: 'button'
            className: 'btn btn-default'
            onClick: @_abort
            autoFocus: true
            onKeyDown: @_onKeyDown
            'Cancel'
          ' '

module.exports = EmojiSelector